<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <script>
        function clock() {
            const date = new Date();
            dt.innerText = date.toLocaleString();
        }
    </script>
</head>

<body>
    <details>
        <summary>Задание 1: Дата и время</summary>
        <span id="datetime"></span>
        <script>
            var dt = document.getElementById("datetime");

            clock();
            setInterval(clock, 1000);
        </script>
    </details>

    <details id="mouse-events">
        <summary>Задание 1.5: События мыши</summary>

        <style>
            details#mouse-events.hover {
                background: greenyellow;
            }
    
            details#mouse-events.hover summary::marker {
                content: 'текст';
            }
        </style>

        <img src="img/leha.png">

        <script>
            const me = document.getElementById("mouse-events");
            const img = me.getElementsByTagName("img")[0];
            const summary = me.getElementsByTagName("summary")[0];

            img.onmouseover = (e) => {
                img.setAttribute('src', 'img/snowball.jpg');
                me.classList.add('hover');
                summary.innerText = 'Задание 2: Лёха и мыши';
            };
            img.onmouseleave = (e) => {
                img.setAttribute('src', 'img/leha.png');
                me.classList.remove('hover');
                summary.innerText = 'Задание 2: События мыши';
            };
        </script>
    </details>

    <details>
        <summary>Задание 2: Календарь</summary>

        <div>
            Задание:
            <ol>
                <li>Добавить к календарю название месяца.</li>
                <li>Выделить субботы и воскресенья</li>
                <li>Подписать дни недели</li>
            </ol>
        </div>

        <style>
            #month {
                font-size: 24px;
            }

            #calendar > tr > td {
                text-align: center;
            }

            #calendar > tr > td:nth-child(6),
            #calendar > tr > td:nth-child(7) {
                color: red;
            }
        </style>

        <div class="calendar-wrapper">
            <div id="month">Апрель 2023</div>
            <table id="calendar">
                <tr>
                    <td>ПН</td>
                    <td>ВТ</td>
                    <td>СР</td>
                    <td>ЧТ</td>
                    <td>ПТ</td>
                    <td>СБ</td>
                    <td>ВС</td>
                </tr>
            </table>
        </div>
        <script>
            const calendarTable = document.getElementById("calendar");

            const firstDayOfWeek = 5;
            const daysInMonth = 30;
            //const weeksInMonth = Math.ceil(30 / 7);

            const firstRow = document.createElement("tr");
            for (let i = 0; i < 7; i++) {
                const newCell = document.createElement("td");

                if (i >= firstDayOfWeek)
                    newCell.innerText = i - firstDayOfWeek + 1;

                firstRow.appendChild(newCell);
            }
            calendarTable.appendChild(firstRow);

            let day = (6 - firstDayOfWeek) + 1; // день с нуля
            for (let i = 0; day < 30; i++) {
                const newRow = document.createElement("tr");
                for (let i = 0; i < 7 && day < 30; i++) {
                    const newCell = document.createElement("td");
                    newCell.innerText = day + 1;
                    day++;
                    newRow.appendChild(newCell);
                }
                calendarTable.appendChild(newRow);
            }
        </script>
    </details>

    <details>
        <summary>Задание 3: Нахождение элементов в DOM&dash;дереве</summary>

        <div>Найти все элементы DOM</div>

        <ul id="elements"></ul>

        <script>
            const domElementsList = document.getElementById("elements");

            const allElementsCollection = document.querySelectorAll("*");
            allElementsCollection.forEach((e) => {
                const newLi = document.createElement("li");
                newLi.innerText = `Тег: ${e.tagName}, Текст: ${e.innerText}`;
                domElementsList.appendChild(newLi);
            });
            //alert(allElementsCollection.length);
        </script>
    </details>

    <details>
        <summary>Задание 4: Изменение объекта</summary>

        <div>Через указанный промежуток времени 50мс выполнить анимацию выбранного блока &mdash; увеличение на 50% с разворотом по часовой стрелке на 180&deg;</div>

        <img src="img/leha.png" id="snowballster">
        <style>
            #snowballster {
                transition: transform linear 0.05s;
            }
        </style>

        <script>
            const snowballster = document.getElementById("snowballster");
            let snowballInterval;
            let is180 = false;
            snowballster.onmouseover = () => {
                snowballInterval = setInterval(() => {
                    snowballster.style.transform = `scale(${is180 ? 1.5 : 1}) rotate(${is180 ? 180 : 360}deg)`;
                    is180 = !is180;
                }, 50);
            };
            snowballster.onmouseleave = () => {
                clearInterval(snowballInterval);
            };
        </script>
    </details>

    <details>
        <summary>Задание 5: Напишите скрипт для создания элемента согласно варианту</summary>
        
        <div>Абзацы в &lt;div&gt;, удаление снизу от текущего</div>

        <button id="z5-create">Создать абзац</button>
        <div id="z5">
        </div>

        <style>
            #z5 p:hover {
                background: yellow;
                color: black;

                cursor: pointer;
            }
        </style>

        <script>
            {
                const z5 = document.getElementById("z5");

                function deleteElement(e) {
                    const el = e.target;
                    if (el === null || el.tagName != "P" || el.nextSibling === null)
                        return;

                    if (confirm("Вы уверены?")) {
                        el.nextSibling.remove();
                    }
                }
                z5.onclick = deleteElement;

                function addElement() {
                    const p = prompt("Сколько добавить абзацев?");
                    if (p === undefined)
                        return;
                    
                    const n = parseInt(p);
                    if (isNaN(n) || n < 0)
                        return;
                    
                    for (let i = 0; i < n; i++) {
                        const inp = prompt("Введите содержимое абзаца:");
                        if (inp === undefined)
                            break;

                        const el = document.createElement("p");
                        el.innerText = inp;
                        z5.appendChild(el);
                    }
                }

                document.getElementById("z5-create").onclick = addElement;
            }
        </script>
    </details>

    <details id="z6">
        <summary>Задание 6: Организовать обработку события</summary>

        <div>Клик в ячейке таблица (4x4) вызывает окно prompt. Текст из него помещается в ячейку.</div>

        <table>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>

        <style>
            #z6 td {
                min-width: 80px;
                height: 24px;
            }

            #z6 td:hover {
                background: rgba(0, 0, 0, 0.1);
            }

            #z6 table, #z6 tr, #z6 td {
                border: 1px solid black;
            }
        </style>

        <script>
            {
                const z6 = document.getElementById("z6");
                z6.onclick = (e) => {
                    const el = e.target;
                    if (el === null || el.tagName != "TD")
                        return;

                    const p = prompt("Введите новый текст ячейки:");
                    if (p) {
                        el.innerText = p;
                    }
                };
            }
        </script>
    </details>

    <details id="z7">
        <summary>Задание 7: Создайте меню, которое раскрывается/сворачивается при клике</summary>

        <h1 id="z7-spoiler">Здесь сладости (нажми на меня!)</h1>
        <div id="z7-sweets" style="display: none">
            <div class="sweet">Пироженое</div>
            <div class="sweet">Мёд</div>
            <div class="sweet">Конфета</div>
        </div>

        <style>
            #z7-spoiler:before {
                content: '➡️';
            }

            #z7-spoiler.active:before {
                content: '⬇️';
            }

            #z7-sweets .sweet {
                opacity: 1;
                cursor: pointer;
                transition: opacity 1s ease-out;
            }
        </style>

        <script>
            {
                const z7spoiler = document.getElementById("z7-spoiler");
                z7spoiler.onclick = () => {
                    if (z7spoiler.classList.contains("active")) {
                        z7spoiler.classList.remove("active");
                        z7spoiler.nextElementSibling.style.display = "none";
                    }
                    else {
                        z7spoiler.classList.add("active");
                        z7spoiler.nextElementSibling.style.display = "block";
                    }
                };

                const z7sweets = document.getElementById("z7-sweets");

                const hasSweets = () => {
                    if (z7sweets.childElementCount == 0) {
                        z7sweets.append("А-а-а всё, всё выжрали!");
                    }
                };

                z7sweets.onclick = (e) => {
                    if (!e.target.classList.contains("sweet") || e.target.style.opacity == "0")
                        return;
                    
                    e.target.style.opacity = 0;
                    setTimeout(() => {
                        e.target.remove();
                        hasSweets();
                    }, 1000);
                };
            }
        </script>
    </details>
</body>

</html>